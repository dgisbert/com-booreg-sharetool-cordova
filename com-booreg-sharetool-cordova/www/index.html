<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="js/jquery.mobile-1.4.5.min.css">
    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/jquery.mobile-1.4.5.min.js"></script>

    <script src="//www.parsecdn.com/js/parse-1.6.7.min.js"></script>

    <script type="text/javascript">
    
        function OpenDetail(id)
        {
            var str =  "";
            
            str += '<ul id="properties" data-role="listview" data-inset="true">';
            str += '<li><a href="javascript:OpenDetail(1)"><img src="img1.png">Texto de la herramienta</a></li>';
            str += '<li><a href="javascript:OpenDetail(2)"><img src="img2.png">Texto de la herramienta2</a></li>';
            str += '</ul>'

            $("#view_properties").html(str);
            
            $("#view_list").html("");

        }

        $(document).ready
        (
            function ()
            {

	            // Parse initialization

	            Parse.initialize("2QePHKyrZMo0v7Q6grxWepfQxUqaSqbx0AMAAExI", "XKDJRAJDAAVt5FuXRI0nAINKPDx5vlltsiGGhVO8");
/* 
	            var TestObject = Parse.Object.extend("TestObject");
	            var testObject = new TestObject();
	            testObject.save({foo: "bar2"}).then(function(object) {
	              alert("yay! it worked");
	            });
            	
 */	            $("#login").on("click",
	            	function()
	                {
	            	    doLogin($("#username").val(), $("#password").val());
	            	}
	            );
	            
				$("#search").on("click", function() { doSearch(); });
	        }
	    );

	    /*
	        Makes a login with Parse
	     */
	    
	    function doLogin(username, password)
	    {
		    Parse.User.logIn(username, password,
		        {
		    	  success: function(user)
		    	  {
		    		  window.location = "#toollist";
		    	  },
		    	  error: function(user, error)
		    	  {
		    		  alert("Invalid username / password")
		    		  window.location = "#loginPage";
		    	  }
		    	}
		    );
	    }

	    /*
			Searches data with the given user constraints 
		*/
		
		function doSearch()
	    {
			var Tool = Parse.Object.extend("Tool");
			var query = new Parse.Query(Tool);

			query.find(
			    {
				    success: function(results)
				    {
			            var str =  "";
			            
			            str += '<ul id="toolList" data-role="listview" data-inset="true">';
			
				    	// Insert HTML code for each result given
				    	
					    for (var i = 0; i < results.length; i++)
					    {
					        var object = results[i];
					        
				            str += '<li>';
				            str += '<div>';
				            str += '<a href="javascript:OpenDetail("' + i + '")"><img src="img/bullet.png">' + object.get('name') + '</a>';
				            str += '</div>';
				            str += '<div>';
				            str += 'Price:' + object.get('pric');
				            str += '</div>';
				            str += '<div>';
				            str += 'Distance:' + object.get('dist');
				            str += '</div>';
				            str += '</li>';
				        }
			            str += '</ul>';

			            $("#toolListDiv").html(str);
			            $("#toolList").listview().listview('refresh');

				    },
				    error: function(error)
				    {
				        alert("Error: " + error.code + " " + error.message);
				    }
				}
			);
	    }
    

    </script>

</head>
<body>

<body>

	<!-- Login page -->
	<div data-role="page" id="loginPage">
	
		<div data-role="header"> <h1>ShareTool</h1> </div>

			<form class="login-form">
				<div class="error" style="display:none"></div>
				<input type="text" id="username" placeholder="Username" />
				<input type="password" id="password" placeholder="Password" />
				<button id="login">Log In</button>
			</form>
	</div>
	
	<!-- Tool List page -->
	<div data-role="page" id="toollist">
	
		<div data-role="header"> <h1>ShareTool</h1> </div>
	
		<div role="main" class="ui-content">

			<div style="display:flex"><label>Long</label><label>Lat</label></div>
			<div style="display:flex;">
			    <label>Dist:</label>
				<input type="number" size="4" id="dist" placeholder="km" />
			    <label>Price</label>
				<input type="number" size="4" id="price" placeholder="€" />
			</div>
			<div style="display:flex">
				<input type="text" size="20" id="searchText" placeholder="Enter search text" />
    			<a id="search" class="ui-btn ui-shadow ui-corner-all" href="#toollist">
					<img src="img/search.png" height="32" width="32"></img>
                </a>
			</div>
			<div style="display:flex">
			    <label for="orderBy">Order by</label>
			    <select name="orderBy" id="orderBy">
			      <option selected="selected">By price asc</option>
			      <option>By distance asc</option>
			      <option>By distance asc</option>
			      <option>By price desc</option>
			      <option>By distance desc</option>
			    </select>
			</div>

			<div id="toolListDiv">
			</div>
		</div>
	
	</div>

	<!-- Tool detail -->
	<div data-role="page" id="tooldetail">
	
		<div data-role="header"> <h1>ShareTool</h1> </div>
	
		<div role="main" class="ui-content">

			<label for="detailToolName"></label>
			<ol data-role="listview">
			    <li>Acura</li>
			    <li>Audi</li>
			    <li>BMW</li>
			    <li>Cadillac</li>
			    <li>Ferrari</li>
			</ol>

		</div>
	
	</div>

</body>
</html>
